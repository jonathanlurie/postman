<div class="wrapper">
  <p>{{message}} </p>
  <input ref:emailInputField class="inputField" bind:value='email' on:keyup='fieldKeyUp(event)' placeholder='you@email.com'>


  <div class="submitButton" on:click='submit()'>subscribe</div>
  <img src="{{logo}}" width="200"/>

  <div class="quitButton" on:click='close()'>[X]</div>
</div>


<style>



  .inputField {
    border-radius: 0;
    text-align: center;
    width: 200px;
    border: 1px solid #EEE;
    font-size: 1em;
    height: 2em;
    background-color: white;
  }

  .inputField:focus {
    outline:none;
  }

  .wrapper {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
    position: fixed;
    width: 100%;
    height: 200px;
    background-color: #fff;
    bottom: 0;
    left: 0;
    right: 0;
  }

  .quitButton {
    position: absolute;
    top: 0;
    right: 0;
    width: 20px;
    height: 20px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 50%;
    padding: 5px;
    cursor: pointer;
  }

  .submitButton {
    display: inline-block;
    background: rgb(104, 204, 247);
    color: white;
    padding: 7px;
    cursor: pointer;
    transition: all 0.2s;
  }

  .submitButton:hover {
    background: rgb(69, 169, 212);
  }

</style>




<script>

  import { Images } from './Images.js';

  function validateEmail(email) {
    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(email.toLowerCase());
  }

  export default {

    data() {
      return {
        email: "",
        logo: Images.postmanLogo
      }
    },

    computed: {
     isEmailValid: function(email){
        return validateEmail( email )
      }

   },

    methods: {
      closeCallback(){ console.warn("must be overloaded externally"); },
      submitCallback(){ console.warn("must be overloaded externally"); },

      fieldKeyUp( evt ){
        this.updateColor();

        // Enter key
        if( evt.keyCode === 13 ){
          this.submit()
        }

      },

      updateColor(){
        this.refs.emailInputField.style.border = this.get("isEmailValid") || (this.get("email") === '')  ? "1px solid #eee" : "1px solid #ffb06b";
        //this.refs.emailInputField.style.backgroundColor = this.get("isEmailValid") || (this.get("email") === '')  ? "white" : "#FAA";
      },

      submit(){
        console.log( this.get("logo") );
        if( this.get("isEmailValid") ){
          this.submitCallback();
        }

      },

      close() {
        this.closeCallback();
        //alert(message); // again, please don't do this
        this.destroy();
      }
    }
  };
</script>
